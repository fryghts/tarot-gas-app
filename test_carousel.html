<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ö–∞—Ä—É—Å–µ–ª—å –¢–∞—Ä–æ - Bento Grid + 3D</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Core Styles -->
    <style>
        /* === BASE RESET === */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --primary-bg: #0A0A0F;
            --secondary-bg: #151520;
            --card-bg: #1A1A2E;
            --glass-bg: rgba(255, 255, 255, 0.06);
            --glass-border: rgba(255, 255, 255, 0.12);
            --text-primary: #FFFFFF;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-muted: rgba(255, 255, 255, 0.5);
            --challenge-color: #FF6B35;
            --path-color: #F7B801;
            --outcome-color: #00D084;
            --ai-color: #7C3AED;
            --font-display: 'Orbitron', monospace;
            --font-body: 'Inter', sans-serif;
        }

        body {
            font-family: var(--font-body);
            background: linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* === LANDING PAGE STYLES === */
        .landing-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            position: relative;
            z-index: 2;
        }

        .landing-title {
            font-family: var(--font-display);
            font-size: clamp(2.5rem, 8vw, 5rem);
            font-weight: 900;
            text-align: center;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--ai-color), #A855F7, #D946EF, var(--challenge-color));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite alternate;
            line-height: 1.1;
        }

        @keyframes titleGlow {
            from { filter: drop-shadow(0 0 20px rgba(124, 58, 237, 0.5)); }
            to { filter: drop-shadow(0 0 40px rgba(124, 58, 237, 0.8)); }
        }

        .landing-subtitle {
            font-size: clamp(1rem, 3vw, 1.5rem);
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 3rem;
            max-width: 800px;
            line-height: 1.6;
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* === DEMO BUTTONS === */
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            max-width: 1000px;
            width: 100%;
            margin-bottom: 3rem;
        }

        .demo-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px) saturate(1.8);
            border: 1px solid var(--glass-border);
            border-radius: 1.5rem;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 1s ease-out both;
        }

        .demo-card:nth-child(1) { animation-delay: 0.8s; }
        .demo-card:nth-child(2) { animation-delay: 1s; }
        .demo-card:nth-child(3) { animation-delay: 1.2s; }

        .demo-card::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, var(--ai-color), transparent, var(--challenge-color), transparent, var(--path-color));
            border-radius: inherit;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .demo-card:hover::before {
            opacity: 0.3;
        }

        .demo-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 60px rgba(124, 58, 237, 0.3);
        }

        .demo-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }

        .demo-title {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .demo-description {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.5;
            margin-bottom: 1.5rem;
        }

        .demo-features {
            list-style: none;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .demo-features li {
            margin-bottom: 0.5rem;
            position: relative;
            padding-left: 1.5rem;
        }

        .demo-features li::before {
            content: '‚ú¶';
            position: absolute;
            left: 0;
            color: var(--ai-color);
        }

        /* === FEATURES SHOWCASE === */
        .features-section {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 2rem;
            padding: 3rem 2rem;
            margin: 2rem 0;
            max-width: 1200px;
            width: 100%;
            animation: fadeInUp 1s ease-out 1.5s both;
        }

        .features-title {
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 2rem;
            color: var(--ai-color);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .feature-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            background: rgba(255, 255, 255, 0.06);
            transform: translateY(-4px);
        }

        .feature-emoji {
            font-size: 2rem;
            margin-bottom: 1rem;
            display: block;
        }

        .feature-name {
            font-family: var(--font-display);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .feature-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* === FLOATING PARTICLES === */
        .particles-container {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, var(--ai-color) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 8s infinite linear;
            opacity: 0.6;
        }

        @keyframes float {
            from {
                transform: translateY(100vh) translateX(-50px);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            to {
                transform: translateY(-10vh) translateX(50px);
                opacity: 0;
            }
        }

        /* === LOADING SPINNER === */
        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(124, 58, 237, 0.3);
            border-top: 2px solid var(--ai-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .landing-container {
                padding: 1rem;
            }
            
            .demo-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .features-section {
                padding: 2rem 1rem;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
        }

        /* === ACCESSIBILITY === */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* === FOCUS STYLES === */
        .demo-card:focus {
            outline: 2px solid var(--ai-color);
            outline-offset: 4px;
        }
    </style>
</head>
<body>
    <!-- Floating Particles Background -->
    <div class="particles-container" id="particles"></div>

    <!-- Landing Content -->
    <div class="landing-container">
        <h1 class="landing-title">üîÆ –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –¢–∞—Ä–æ</h1>
        <p class="landing-subtitle">
            –†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω –∫–∞—Ä—É—Å–µ–ª–∏ —Å Bento Grid Layout, 3D –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏, 
            –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏. –û—Ç–∫—Ä–æ–π—Ç–µ –±—É–¥—É—â–µ–µ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤.
        </p>

        <!-- Demo Options -->
        <div class="demo-grid">
            <div class="demo-card" onclick="startSingleCardDemo()" tabindex="0" role="button">
                <span class="demo-icon">üÉè</span>
                <h3 class="demo-title">–û–¥–∏–Ω–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞</h3>
                <p class="demo-description">
                    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç —Å 3D –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º –ø–æ–∫–∞–∑–æ–º –¥–µ—Ç–∞–ª–µ–π.
                </p>
                <ul class="demo-features">
                    <li>3D flip –∞–Ω–∏–º–∞—Ü–∏–∏</li>
                    <li>–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ</li>
                    <li>Kinetic typography</li>
                </ul>
            </div>

            <div class="demo-card" onclick="startFullSpreadDemo()" tabindex="0" role="button">
                <span class="demo-icon">üé¥</span>
                <h3 class="demo-title">–ü–æ–ª–Ω—ã–π —Ä–∞—Å–∫–ª–∞–¥</h3>
                <p class="demo-description">
                    –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å Bento Grid Layout, minimap –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ 3D –∫–∞—Ä—Ç–∞–º–∏.
                </p>
                <ul class="demo-features">
                    <li>Bento Grid Layout</li>
                    <li>Minimap –Ω–∞–≤–∏–≥–∞—Ü–∏—è</li>
                    <li>–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø–∞–Ω–µ–ª–∏</li>
                </ul>
            </div>

            <div class="demo-card" onclick="startAIOracleDemo()" tabindex="0" role="button">
                <span class="demo-icon">ü§ñ</span>
                <h3 class="demo-title">AI –û—Ä–∞–∫—É–ª</h3>
                <p class="demo-description">
                    –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞—Å–∫–ª–∞–¥–∞ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.
                </p>
                <ul class="demo-features">
                    <li>–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π AI</li>
                    <li>Gemini API</li>
                    <li>–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑</li>
                </ul>
            </div>
        </div>

        <!-- Features Showcase -->
        <section class="features-section">
            <h2 class="features-title">‚ú® –†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</h2>
            <div class="features-grid">
                <div class="feature-item">
                    <span class="feature-emoji">üèóÔ∏è</span>
                    <h4 class="feature-name">Bento Grid Layout</h4>
                    <p class="feature-desc">–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–º–µ—Å—Ç–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã—Ö –º–æ–¥–∞–ª–µ–π</p>
                </div>
                
                <div class="feature-item">
                    <span class="feature-emoji">üé≤</span>
                    <h4 class="feature-name">3D Interactive Cards</h4>
                    <p class="feature-desc">–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ 3D –∞–Ω–∏–º–∞—Ü–∏–∏ —Å physics-based –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ –∏ hover —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏</p>
                </div>
                
                <div class="feature-item">
                    <span class="feature-emoji">üìä</span>
                    <h4 class="feature-name">Progress System</h4>
                    <p class="feature-desc">–í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏</p>
                </div>
                
                <div class="feature-item">
                    <span class="feature-emoji">üó∫Ô∏è</span>
                    <h4 class="feature-name">Minimap Navigation</h4>
                    <p class="feature-desc">–ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å –ø—Ä–µ–≤—å—é –∫–∞—Ä—Ç –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</p>
                </div>
                
                <div class="feature-item">
                    <span class="feature-emoji">üß†</span>
                    <h4 class="feature-name">Integrated AI</h4>
                    <p class="feature-desc">–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Gemini AI –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞—Å–∫–ª–∞–¥–∞</p>
                </div>
                
                <div class="feature-item">
                    <span class="feature-emoji">‚ú®</span>
                    <h4 class="feature-name">Micro-animations</h4>
                    <p class="feature-desc">–°–æ—Ç–Ω–∏ –º–µ–ª–∫–∏—Ö –∞–Ω–∏–º–∞—Ü–∏–π –¥–ª—è –∂–∏–≤–æ–≥–æ –∏ –æ—Ç–∑—ã–≤—á–∏–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</p>
                </div>
                
                <div class="feature-item">
                    <span class="feature-emoji">üì±</span>
                    <h4 class="feature-name">Responsive Design</h4>
                    <p class="feature-desc">–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å —É–º–Ω—ã–º–∏ breakpoint –∏ –º–æ–±–∏–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</p>
                </div>
                
                <div class="feature-item">
                    <span class="feature-emoji">‚ôø</span>
                    <h4 class="feature-name">Accessibility</h4>
                    <p class="feature-desc">–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ screen readers</p>
                </div>
            </div>
        </section>

        <!-- Tech Info -->
        <div style="margin-top: 2rem; padding: 2rem; background: rgba(255,255,255,0.05); border-radius: 1rem; text-align: center;">
            <p style="color: var(--text-muted); font-size: 0.9rem;">
                <strong>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:</strong> CSS Grid, GSAP Animations, Glassmorphism, Progressive Enhancement, 
                Modern JavaScript ES2024, Responsive Design, Web Accessibility
            </p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <!-- Include the data and carousel files -->
    <script>
        // Embed card data directly to avoid external dependencies
        const tarotCardsData = [
            {
                id: 0,
                name: "–î—É—Ä–∞–∫ (–®—É—Ç)",
                keyword: "–ù–ê–ß–ê–õ–û",
                prophecy: {
                    challenge: "–ë–µ–ª—ã–π –ª–∏—Å—Ç —Ç–≤–æ–µ–≥–æ –±—É–¥—É—â–µ–≥–æ –ø—É–≥–∞–µ—Ç –±–æ–ª—å—à–µ, —á–µ–º —Å–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è –æ—à–∏–±–∫–∞.",
                    path: "–°–¥–µ–ª–∞–π –ø–µ—Ä–≤—ã–π —à–∞–≥, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—à—å –≤—Å–µ–π –ª–µ—Å—Ç–Ω–∏—Ü—ã.",
                    outcome: "–û–¥–Ω–æ-–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–ª–æ–≤–æ, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–µ –≤ –ø—É—Å—Ç–æ—Ç–µ, –ø–æ—Ä–æ–¥–∏—Ç —Ü–µ–ª—É—é –≤—Å–µ–ª–µ–Ω–Ω—É—é."
                },
                image: "https://via.placeholder.com/300x480/4C0052/FFFFFF?text=üÉè"
            },
            {
                id: 1,
                name: "–ú–∞–≥",
                keyword: "–°–û–ó–î–ê–ù–ò–ï", 
                prophecy: {
                    challenge: "–¢–≤–æ–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ–∫—Ä—ã—Ç—ã –ø—ã–ª—å—é, –ø–æ–∫–∞ —Ç—ã –∏—â–µ—à—å –∏–¥–µ–∞–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–∏–¥–∞–Ω–∏—è.",
                    path: "–°–æ—Ç–≤–æ—Ä–∏ —á—É–¥–æ –∏–∑ —Ç–æ–≥–æ, —á—Ç–æ —É–∂–µ –ª–µ–∂–∏—Ç –Ω–∞ —Ç–≤–æ—ë–º —Å—Ç–æ–ª–µ.",
                    outcome: "–¢—ã —Å—Ç–∞–Ω–µ—à—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–æ–º —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏, —Å–ø–æ—Å–æ–±–Ω—ã–º –≤–æ–ø–ª–æ—â–∞—Ç—å –º—ã—Å–ª–∏ –≤ –º–∞—Ç–µ—Ä–∏—é."
                },
                image: "https://via.placeholder.com/300x480/660066/FFFFFF?text=üîÆ"
            },
            {
                id: 2,
                name: "–ñ—Ä–∏—Ü–∞",
                keyword: "–ò–ù–¢–£–ò–¶–ò–Ø",
                prophecy: {
                    challenge: "–¢—ã –∏—â–µ—à—å –æ—Ç–≤–µ—Ç—ã –≤ –≥—Ä–æ–º–∫–∏—Ö —Ä–µ—á–∞—Ö, —Ö–æ—Ç—è –∏—Å—Ç–∏–Ω–∞ —à–µ–ø—á–µ—Ç –≤ –ø–æ–ª–Ω–æ–π —Ç–∏—à–∏–Ω–µ.",
                    path: "–ü—Ä–∏—Å–ª—É—à–∞–π—Å—è –∫ —Ç–µ—á–µ–Ω–∏—è–º –ø–æ–¥ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å—é ‚Äî —Ç–∞–º —Å–∫—Ä—ã—Ç—ã –Ω–∞—Å—Ç–æ—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ.",
                    outcome: "–¢–µ–±–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∑–Ω–∞–Ω–∏–µ, –Ω–µ –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–µ –Ω–∏ –≤ –æ–¥–Ω–æ–π –∫–Ω–∏–≥–µ."
                },
                image: "https://via.placeholder.com/300x480/c49952/FFFFFF?text=üåô"
            }
        ];

        // === DEMO FUNCTIONS (defined early to avoid ReferenceError) === //
        function getRandomCard() {
            const randomIndex = Math.floor(Math.random() * tarotCardsData.length);
            return tarotCardsData[randomIndex];
        }

        function getRandomCards(count) {
            const shuffled = [...tarotCardsData].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        // Define demo functions globally
        window.startSingleCardDemo = function() {
            console.log('Starting single card demo...');
            const randomCard = getRandomCard();
            if (window.ModernCarousel) {
                window.ModernCarousel.initialize([randomCard], true);
            } else {
                console.error('ModernCarousel not loaded yet');
            }
        };

        window.startFullSpreadDemo = function() {
            console.log('Starting full spread demo...');
            const randomCards = getRandomCards(3);
            if (window.ModernCarousel) {
                window.ModernCarousel.initialize(randomCards, false);
            } else {
                console.error('ModernCarousel not loaded yet');
            }
        };

        window.startAIOracleDemo = function() {
            console.log('Starting AI Oracle demo...');
            const randomCards = getRandomCards(3);
            if (window.ModernCarousel) {
                window.ModernCarousel.initialize(randomCards, false).then(() => {
                    // Auto navigate to AI Oracle after 3 seconds
                    setTimeout(() => {
                        const totalCards = randomCards.length;
                        window.ModernCarousel.goToCard(totalCards); // Go to AI card
                    }, 3000);
                });
            } else {
                console.error('ModernCarousel not loaded yet');
            }
        };
    </script>
    
    <script>
        // === CAROUSEL STYLES (embedded to avoid external files) ===
        const carouselStyles = `
        /* Modern Tarot Carousel Styles */
        .tarot-carousel-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, rgba(10, 10, 15, 0.95) 0%, rgba(21, 21, 32, 0.98) 50%, rgba(10, 10, 15, 0.95) 100%);
            backdrop-filter: blur(20px) saturate(1.8);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            display: grid;
            grid-template-columns: 380px 1fr 320px;
            grid-template-rows: 80px 1fr 60px;
            grid-template-areas: "header header header" "sidebar main panel" "footer footer footer";
            gap: 1.5rem;
            padding: 1.5rem;
        }

        .tarot-carousel-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .carousel-header {
            grid-area: header;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px) saturate(1.8);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 1.5rem;
            padding: 1rem 1.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .carousel-title {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #7C3AED, #A855F7, #D946EF);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .progress-container {
            flex: 1;
            max-width: 400px;
            margin: 0 2rem;
        }

        .progress-track {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF6B35, #F7B801, #00D084);
            border-radius: 0.5rem;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
        }

        .progress-step {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: color 0.3s;
        }

        .progress-step.active {
            color: #FFFFFF;
        }

        .close-button {
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 0.75rem;
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.12);
            color: #FFFFFF;
            font-size: 1.125rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-button:hover {
            background: rgba(255, 68, 68, 0.2);
            border-color: #FF4444;
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.3);
        }

        .carousel-sidebar {
            grid-area: sidebar;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .card-minimap {
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px) saturate(1.8);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .minimap-title {
            font-family: var(--font-display);
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #FFFFFF;
        }

        .minimap-cards {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .minimap-card {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid transparent;
        }

        .minimap-card:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(4px);
        }

        .minimap-card.active {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.12);
        }

        .minimap-card-thumb {
            width: 40px;
            height: 64px;
            border-radius: 0.5rem;
            background-size: cover;
            background-position: center;
            border: 1px solid rgba(255, 255, 255, 0.12);
            flex-shrink: 0;
        }

        .minimap-card-info {
            flex: 1;
            min-width: 0;
        }

        .minimap-card-name {
            font-size: 0.875rem;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 0.25rem;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }

        .minimap-card-type {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .challenge-type { color: #FF6B35; }
        .path-type { color: #F7B801; }
        .outcome-type { color: #00D084; }
        .ai-type { color: #7C3AED; }

        .carousel-main {
            grid-area: main;
            display: flex;
            align-items: center;
            justify-content: center;
            perspective: 1200px;
            position: relative;
            overflow: hidden;
        }

        .card-stage {
            width: 100%;
            height: 100%;
            max-width: 500px;
            max-height: 700px;
            position: relative;
            transform-style: preserve-3d;
        }

        .card-3d {
            width: 100%;
            height: 100%;
            position: absolute;
            transform-style: preserve-3d;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .card-3d.active {
            z-index: 10;
        }

        .card-3d.prev {
            transform: translateX(-60%) scale(0.8) rotateY(25deg);
            opacity: 0.6;
            z-index: 5;
        }

        .card-3d.next {
            transform: translateX(60%) scale(0.8) rotateY(-25deg);
            opacity: 0.6;
            z-index: 5;
        }

        .card-3d.hidden {
            transform: translateX(0) scale(0.4) translateZ(-200px);
            opacity: 0;
            z-index: 1;
        }

        .card-inner {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 1.5rem;
            overflow: hidden;
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.25);
        }

        .card-back {
            background: linear-gradient(135deg, #151520, #1A1A2E);
            border: 2px solid rgba(255, 255, 255, 0.12);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-back::before {
            content: 'üÉè';
            font-size: 4rem;
            opacity: 0.3;
        }

        .card-front {
            transform: rotateY(180deg);
            background-size: cover;
            background-position: center;
            border: 2px solid;
            position: relative;
            overflow: hidden;
        }

        .card-front.challenge-theme { border-color: #FF6B35; }
        .card-front.path-theme { border-color: #F7B801; }
        .card-front.outcome-theme { border-color: #00D084; }
        .card-front.ai-theme { border-color: #7C3AED; }

        .card-front::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent 0%, rgba(0, 0, 0, 0.3) 50%, rgba(0, 0, 0, 0.6) 100%);
        }

        .card-glow {
            position: absolute;
            inset: -20px;
            border-radius: 2rem;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: -1;
            filter: blur(20px);
        }

        .card-3d.active .card-glow {
            opacity: 1;
        }

        .card-3d.active .card-front.challenge-theme ~ .card-glow {
            background: radial-gradient(circle, #FF6B35 0%, transparent 70%);
        }

        .card-3d.active .card-front.path-theme ~ .card-glow {
            background: radial-gradient(circle, #F7B801 0%, transparent 70%);
        }

        .card-3d.active .card-front.outcome-theme ~ .card-glow {
            background: radial-gradient(circle, #00D084 0%, transparent 70%);
        }

        .card-3d.active .card-front.ai-theme ~ .card-glow {
            background: radial-gradient(circle, #7C3AED 0%, transparent 70%);
        }

        .carousel-panel {
            grid-area: panel;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .card-details {
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px) saturate(1.8);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            flex: 1;
            overflow-y: auto;
        }

        .card-details-content {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-details-content.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .card-name {
            font-family: var(--font-display);
            font-size: 1.875rem;
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #FFFFFF, rgba(255, 255, 255, 0.8));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .card-keyword {
            display: inline-block;
            font-family: var(--font-display);
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            border: 1px solid;
            position: relative;
            overflow: hidden;
        }

        .card-keyword::before {
            content: '';
            position: absolute;
            inset: 0;
            opacity: 0.1;
            transition: opacity 0.3s;
        }

        .card-keyword:hover::before {
            opacity: 0.2;
        }

        .challenge-keyword {
            color: #FF6B35;
            border-color: #FF6B35;
        }

        .challenge-keyword::before {
            background: #FF6B35;
        }

        .path-keyword {
            color: #F7B801;
            border-color: #F7B801;
        }

        .path-keyword::before {
            background: #F7B801;
        }

        .outcome-keyword {
            color: #00D084;
            border-color: #00D084;
        }

        .outcome-keyword::before {
            background: #00D084;
        }

        .ai-keyword {
            color: #7C3AED;
            border-color: #7C3AED;
        }

        .ai-keyword::before {
            background: #7C3AED;
        }

        .card-prophecy {
            font-size: 1.125rem;
            line-height: 1.7;
            color: rgba(255, 255, 255, 0.7);
            position: relative;
            padding: 1.5rem;
            border-radius: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            font-style: italic;
        }

        .card-prophecy::before {
            content: '"';
            position: absolute;
            top: 0.5rem;
            left: 1rem;
            font-size: 2.25rem;
            color: #7C3AED;
            opacity: 0.4;
            font-family: serif;
        }

        .card-prophecy::after {
            content: '"';
            position: absolute;
            bottom: 0.5rem;
            right: 1rem;
            font-size: 2.25rem;
            color: #7C3AED;
            opacity: 0.4;
            font-family: serif;
        }

        .ai-assistant {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), rgba(168, 85, 247, 0.05));
            backdrop-filter: blur(20px) saturate(1.8);
            border: 1px solid #7C3AED;
            border-radius: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1), 0 0 30px rgba(124, 58, 237, 0.2);
            position: relative;
            overflow: hidden;
        }

        .ai-assistant::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(124, 58, 237, 0.05), transparent);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .ai-title {
            font-family: var(--font-display);
            font-size: 1.25rem;
            font-weight: 700;
            color: #7C3AED;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .ai-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .ai-input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            color: #FFFFFF;
            font-family: var(--font-body);
            font-size: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            resize: vertical;
            min-height: 80px;
        }

        .ai-input:focus {
            outline: none;
            border-color: #7C3AED;
            background: rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 20px rgba(124, 58, 237, 0.2);
        }

        .ai-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
        }

        .ai-button {
            background: linear-gradient(135deg, #7C3AED, #A855F7);
            border: none;
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: #FFFFFF;
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ai-button::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.5s;
        }

        .ai-button:hover::before {
            transform: translateX(100%);
        }

        .ai-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(124, 58, 237, 0.4);
        }

        .ai-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .ai-response {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(124, 58, 237, 0.2);
            border-radius: 0.75rem;
            padding: 1rem;
            min-height: 120px;
            max-height: 200px;
            overflow-y: auto;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
            font-size: 1rem;
            display: none;
            scrollbar-width: thin;
            scrollbar-color: #7C3AED transparent;
        }

        .ai-response.visible {
            display: block;
            animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .ai-response::-webkit-scrollbar {
            width: 4px;
        }

        .ai-response::-webkit-scrollbar-track {
            background: transparent;
        }

        .ai-response::-webkit-scrollbar-thumb {
            background: #7C3AED;
            border-radius: 0.5rem;
        }

        .carousel-footer {
            grid-area: footer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px) saturate(1.8);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 1.5rem;
            padding: 1rem 1.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .nav-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .nav-button {
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 0.75rem;
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.12);
            color: #FFFFFF;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-button:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(124, 58, 237, 0.3);
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .card-counter {
            font-family: var(--font-display);
            font-size: 0.875rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.7);
        }

        .quick-actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .quick-action {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .quick-action:hover {
            background: rgba(255, 255, 255, 0.08);
            color: #FFFFFF;
            transform: translateY(-1px);
        }

        /* === RESPONSIVE === */
        @media (max-width: 1400px) {
            .tarot-carousel-overlay {
                grid-template-columns: 320px 1fr 280px;
            }
            
            .card-stage {
                max-width: 400px;
                max-height: 600px;
            }
        }

        @media (max-width: 1200px) {
            .tarot-carousel-overlay {
                grid-template-columns: 280px 1fr 260px;
                gap: 1rem;
                padding: 1rem;
            }
            
            .carousel-header {
                padding: 0.75rem 1rem;
            }
            
            .carousel-title {
                font-size: 1.25rem;
            }
        }

        @media (max-width: 1024px) {
            .tarot-carousel-overlay {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr auto auto;
                grid-template-areas: "header" "main" "panel" "sidebar" "footer";
                gap: 1rem;
                padding: 1rem;
            }
            
            .carousel-sidebar {
                order: 4;
            }
            
            .carousel-panel {
                order: 3;
                max-height: 300px;
            }
            
            .card-stage {
                max-width: 350px;
                max-height: 500px;
            }
            
            .minimap-cards {
                flex-direction: row;
                overflow-x: auto;
                padding-bottom: 0.5rem;
                gap: 0.5rem;
            }
            
            .minimap-card {
                flex-shrink: 0;
                width: 200px;
            }
        }

        @media (max-width: 768px) {
            .tarot-carousel-overlay {
                padding: 0.75rem;
                gap: 0.75rem;
            }
            
            .carousel-header {
                padding: 0.75rem;
                flex-direction: column;
                gap: 0.75rem;
            }
            
            .progress-container {
                margin: 0;
                max-width: none;
                width: 100%;
            }
            
            .carousel-title {
                font-size: 1.125rem;
            }
            
            .card-stage {
                max-width: 280px;
                max-height: 400px;
            }
            
            .card-name {
                font-size: 1.5rem;
            }
            
            .card-prophecy {
                font-size: 1rem;
                padding: 1rem;
            }
            
            .nav-button {
                width: 40px;
                height: 40px;
            }
            
            .minimap-card {
                width: 160px;
            }
            
            .minimap-card-thumb {
                width: 32px;
                height: 48px;
            }
        }

        @media (max-width: 480px) {
            .tarot-carousel-overlay {
                padding: 0.5rem;
                gap: 0.5rem;
            }
            
            .carousel-header,
            .carousel-footer,
            .card-minimap,
            .card-details,
            .ai-assistant {
                padding: 1rem;
            }
            
            .card-stage {
                max-width: 240px;
                max-height: 340px;
            }
            
            .carousel-title {
                font-size: 1rem;
            }
            
            .card-name {
                font-size: 1.25rem;
            }
            
            .quick-actions {
                flex-direction: column;
                align-items: stretch;
                width: 100%;
            }
            
            .quick-action {
                text-align: center;
            }
        }
        `;

        // Inject carousel styles
        const styleEl = document.createElement('style');
        styleEl.textContent = carouselStyles;
        document.head.appendChild(styleEl);
    </script>

    <script>
        // === MODERN CAROUSEL CLASS (embedded) ===
        class ModernTarotCarousel {
            constructor() {
                this.cards = [];
                this.currentCardIndex = 0;
                this.isAnimating = false;
                this.isInitialized = false;
                this.overlay = null;
                this.progressFill = null;
                this.progressSteps = null;
                this.cardStage = null;
                this.cardDetails = null;
                this.minimap = null;
                this.aiInput = null;
                this.aiButton = null;
                this.aiResponse = null;
                
                this.config = {
                    animationDuration: 0.8,
                    cardSpacing: 120,
                    autoProgressDelay: 2000,
                    maxMobileCards: 3
                };
                
                this.themes = {
                    challenge: { color: '#FF6B35', name: '–í—ã–∑–æ–≤' },
                    path: { color: '#F7B801', name: '–ü—É—Ç—å' },
                    outcome: { color: '#00D084', name: '–ò—Å—Ö–æ–¥' },
                    ai: { color: '#7C3AED', name: '–û—Ä–∞–∫—É–ª' }
                };
                
                this.handleKeyboard = this.handleKeyboard.bind(this);
                this.handleResize = this.handleResize.bind(this);
                this.nextCard = this.nextCard.bind(this);
                this.prevCard = this.prevCard.bind(this);
                this.closeCarousel = this.closeCarousel.bind(this);
            }

            async initialize(cards, showProgressively = false) {
                if (this.isInitialized) {
                    console.warn('Carousel already initialized');
                    return;
                }

                this.cards = [...cards];
                if (showProgressively) {
                    this.currentCardIndex = this.cards.length - 1;
                }

                try {
                    await this.createCarouselHTML();
                    this.attachEventListeners();
                    this.initializeUI();
                    
                    if (showProgressively) {
                        await this.showProgressively();
                    } else {
                        await this.showAll();
                    }
                    
                    this.isInitialized = true;
                } catch (error) {
                    console.error('Failed to initialize carousel:', error);
                    throw error;
                }
            }

            async createCarouselHTML() {
                const existingOverlay = document.getElementById('tarot-carousel-modern');
                if (existingOverlay) {
                    existingOverlay.remove();
                }

                const overlay = document.createElement('div');
                overlay.id = 'tarot-carousel-modern';
                overlay.className = 'tarot-carousel-overlay';
                
                overlay.innerHTML = `
                    <header class="carousel-header">
                        <h1 class="carousel-title">
                            <span>üîÆ</span>
                            <span>–¶–∏—Ñ—Ä–æ–≤–æ–π –û—Ä–∞–∫—É–ª</span>
                        </h1>
                        <div class="progress-container">
                            <div class="progress-track">
                                <div class="progress-fill"></div>
                            </div>
                            <div class="progress-steps">
                                <span class="progress-step active">–í—ã–∑–æ–≤</span>
                                <span class="progress-step">–ü—É—Ç—å</span>
                                <span class="progress-step">–ò—Å—Ö–æ–¥</span>
                                <span class="progress-step">–û—Ä–∞–∫—É–ª</span>
                            </div>
                        </div>
                        <button class="close-button" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
                    </header>

                    <aside class="carousel-sidebar">
                        <div class="card-minimap">
                            <h3 class="minimap-title">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h3>
                            <div class="minimap-cards"></div>
                        </div>
                    </aside>

                    <main class="carousel-main" role="main">
                        <div class="card-stage"></div>
                    </main>

                    <section class="carousel-panel">
                        <div class="card-details">
                            <div class="card-details-content"></div>
                        </div>
                        <div class="ai-assistant">
                            <h3 class="ai-title">
                                <span>ü§ñ</span>
                                <span>AI –ê–Ω–∞–ª–∏–∑</span>
                            </h3>
                            <div class="ai-input-group">
                                <textarea 
                                    class="ai-input" 
                                    placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –≤–∞—à–µ–º —Ä–∞—Å–∫–ª–∞–¥–µ..."
                                    rows="3"
                                    maxlength="500"
                                ></textarea>
                                <button class="ai-button">
                                    <span class="ai-button-text">–°–ø—Ä–æ—Å–∏—Ç—å</span>
                                </button>
                            </div>
                            <div class="ai-response"></div>
                        </div>
                    </section>

                    <footer class="carousel-footer">
                        <div class="nav-controls">
                            <button class="nav-button prev-button" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∞—è –∫–∞—Ä—Ç–∞">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                                </svg>
                            </button>
                            <span class="card-counter">1 –∏–∑ ${this.cards.length}</span>
                            <button class="nav-button next-button" aria-label="–°–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–∞">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="quick-actions">
                            <a href="#" class="quick-action" onclick="event.preventDefault(); window.ModernCarousel.shuffleCards()">üîÑ –ü–µ—Ä–µ–º–µ—à–∞—Ç—å</a>
                            <a href="#" class="quick-action" onclick="event.preventDefault(); window.ModernCarousel.shareReading()">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</a>
                        </div>
                    </footer>
                `;

                document.body.appendChild(overlay);
                
                this.overlay = overlay;
                this.progressFill = overlay.querySelector('.progress-fill');
                this.progressSteps = overlay.querySelectorAll('.progress-step');
                this.cardStage = overlay.querySelector('.card-stage');
                this.cardDetails = overlay.querySelector('.card-details-content');
                this.minimap = overlay.querySelector('.minimap-cards');
                this.aiInput = overlay.querySelector('.ai-input');
                this.aiButton = overlay.querySelector('.ai-button');
                this.aiResponse = overlay.querySelector('.ai-response');
                
                return overlay;
            }

            attachEventListeners() {
                this.overlay.querySelector('.prev-button').addEventListener('click', this.prevCard);
                this.overlay.querySelector('.next-button').addEventListener('click', this.nextCard);
                this.overlay.querySelector('.close-button').addEventListener('click', this.closeCarousel);
                
                this.aiButton.addEventListener('click', () => this.requestAIAnalysis());
                this.aiInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
                        this.requestAIAnalysis();
                    }
                });
                
                document.addEventListener('keydown', this.handleKeyboard);
                window.addEventListener('resize', this.handleResize);
                
                this.cardStage.addEventListener('click', (e) => {
                    const card = e.target.closest('.card-3d');
                    if (card && !this.isAnimating) {
                        const index = parseInt(card.dataset.index);
                        if (index !== this.currentCardIndex) {
                            this.goToCard(index);
                        } else {
                            this.flipCurrentCard();
                        }
                    }
                });
            }

            initializeUI() {
                this.createCards();
                this.createMinimap();
                this.updateProgress();
                this.updateCardDetails();
                this.updateNavigation();
                this.setLoadingState(false);
            }

            createCards() {
                this.cardStage.innerHTML = '';
                
                this.cards.forEach((card, index) => {
                    const cardElement = this.createCardElement(card, index);
                    this.cardStage.appendChild(cardElement);
                });
                
                if (this.cards.length >= 3) {
                    const aiCard = this.createAICard();
                    this.cardStage.appendChild(aiCard);
                }
                
                this.positionCards();
            }

            createCardElement(card, index) {
                const themes = ['challenge', 'path', 'outcome'];
                const theme = themes[index] || 'ai';
                
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card-3d';
                cardDiv.dataset.index = index;
                cardDiv.innerHTML = `
                    <div class="card-inner">
                        <div class="card-face card-back">
                            <div class="card-back-pattern"></div>
                        </div>
                        <div class="card-face card-front ${theme}-theme" style="background-image: url('${card.image}')">
                        </div>
                        <div class="card-glow"></div>
                    </div>
                `;
                
                return cardDiv;
            }

            createAICard() {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card-3d ai-card';
                cardDiv.dataset.index = this.cards.length;
                cardDiv.innerHTML = `
                    <div class="card-inner">
                        <div class="card-face card-back">
                            <div class="card-back-pattern"></div>
                        </div>
                        <div class="card-face card-front ai-theme" style="background-image: url('https://via.placeholder.com/300x480/7C3AED/FFFFFF?text=ü§ñ');">
                        </div>
                        <div class="card-glow"></div>
                    </div>
                `;
                
                return cardDiv;
            }

            createMinimap() {
                this.minimap.innerHTML = '';
                
                this.cards.forEach((card, index) => {
                    const themes = ['challenge', 'path', 'outcome'];
                    const theme = themes[index] || 'ai';
                    
                    const minimapCard = document.createElement('div');
                    minimapCard.className = 'minimap-card';
                    minimapCard.dataset.index = index;
                    minimapCard.innerHTML = `
                        <div class="minimap-card-thumb" style="background-image: url('${card.image}')"></div>
                        <div class="minimap-card-info">
                            <div class="minimap-card-name">${card.name}</div>
                            <div class="minimap-card-type ${theme}-type">${this.themes[theme].name}</div>
                        </div>
                    `;
                    
                    minimapCard.addEventListener('click', () => this.goToCard(index));
                    this.minimap.appendChild(minimapCard);
                });
                
                if (this.cards.length >= 3) {
                    const aiMinimapCard = document.createElement('div');
                    aiMinimapCard.className = 'minimap-card';
                    aiMinimapCard.dataset.index = this.cards.length;
                    aiMinimapCard.innerHTML = `
                        <div class="minimap-card-thumb" style="background-image: url('https://via.placeholder.com/40x64/7C3AED/FFFFFF?text=ü§ñ')"></div>
                        <div class="minimap-card-info">
                            <div class="minimap-card-name">AI –û—Ä–∞–∫—É–ª</div>
                            <div class="minimap-card-type ai-type">–ê–Ω–∞–ª–∏–∑</div>
                        </div>
                    `;
                    
                    aiMinimapCard.addEventListener('click', () => this.goToCard(this.cards.length));
                    this.minimap.appendChild(aiMinimapCard);
                }
            }

            positionCards() {
                const cards = this.cardStage.querySelectorAll('.card-3d');
                
                cards.forEach((card, index) => {
                    const isActive = index === this.currentCardIndex;
                    const isPrev = index === this.currentCardIndex - 1;
                    const isNext = index === this.currentCardIndex + 1;
                    
                    card.classList.remove('active', 'prev', 'next', 'hidden');
                    
                    if (isActive) {
                        card.classList.add('active');
                    } else if (isPrev) {
                        card.classList.add('prev');
                    } else if (isNext) {
                        card.classList.add('next');
                    } else {
                        card.classList.add('hidden');
                    }
                });
            }

            updateProgress() {
                const totalSteps = this.cards.length + 1;
                const currentStep = this.currentCardIndex + 1;
                const progress = (currentStep / totalSteps) * 100;
                
                if (this.progressFill) {
                    gsap.to(this.progressFill, {
                        width: `${progress}%`,
                        duration: 0.5,
                        ease: 'power2.out'
                    });
                }
                
                this.progressSteps.forEach((step, index) => {
                    const isActive = index <= this.currentCardIndex;
                    step.classList.toggle('active', isActive);
                });
            }

            updateCardDetails() {
                if (!this.cardDetails) return;
                
                const isAICard = this.currentCardIndex >= this.cards.length;
                let content = '';
                
                if (isAICard) {
                    content = `
                        <div class="card-name">ü§ñ AI –û—Ä–∞–∫—É–ª</div>
                        <div class="card-keyword ai-keyword">–ê–ù–ê–õ–ò–ó</div>
                        <div class="card-prophecy">
                            –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤–∞—à–µ–≥–æ —Ä–∞—Å–∫–ª–∞–¥–∞. 
                            –ó–∞–¥–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –æ –∫–∞—Ä—Ç–∞—Ö, –∏—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ 
                            –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏.
                        </div>
                    `;
                } else {
                    const card = this.cards[this.currentCardIndex];
                    const themes = ['challenge', 'path', 'outcome'];
                    const theme = themes[this.currentCardIndex] || 'ai';
                    const prophecyKey = themes[this.currentCardIndex] || 'challenge';
                    
                    content = `
                        <div class="card-name">${card.name}</div>
                        <div class="card-keyword ${theme}-keyword">${card.keyword}</div>
                        <div class="card-prophecy">${card.prophecy[prophecyKey] || card.prophecy.challenge}</div>
                    `;
                }
                
                gsap.to(this.cardDetails, {
                    opacity: 0,
                    y: 20,
                    duration: 0.3,
                    ease: 'power2.in',
                    onComplete: () => {
                        this.cardDetails.innerHTML = content;
                        gsap.to(this.cardDetails, {
                            opacity: 1,
                            y: 0,
                            duration: 0.4,
                            ease: 'power2.out'
                        });
                        this.cardDetails.classList.add('visible');
                    }
                });
            }

            updateMinimap() {
                const minimapCards = this.minimap.querySelectorAll('.minimap-card');
                minimapCards.forEach((card, index) => {
                    const isActive = index === this.currentCardIndex;
                    card.classList.toggle('active', isActive);
                });
            }

            updateNavigation() {
                const prevButton = this.overlay.querySelector('.prev-button');
                const nextButton = this.overlay.querySelector('.next-button');
                const counter = this.overlay.querySelector('.card-counter');
                
                const totalCards = this.cards.length + 1;
                const currentNum = this.currentCardIndex + 1;
                
                if (prevButton) prevButton.disabled = this.currentCardIndex <= 0;
                if (nextButton) nextButton.disabled = this.currentCardIndex >= totalCards - 1;
                if (counter) counter.textContent = `${currentNum} –∏–∑ ${totalCards}`;
            }

            async goToCard(index) {
                if (this.isAnimating || index === this.currentCardIndex) return;
                
                const totalCards = this.cards.length + 1;
                if (index < 0 || index >= totalCards) return;
                
                this.isAnimating = true;
                this.currentCardIndex = index;
                
                this.positionCards();
                this.updateProgress();
                this.updateCardDetails();
                this.updateMinimap();
                this.updateNavigation();
                
                await new Promise(resolve => setTimeout(resolve, this.config.animationDuration * 1000));
                this.isAnimating = false;
            }

            async nextCard() {
                const totalCards = this.cards.length + 1;
                if (this.currentCardIndex < totalCards - 1) {
                    await this.goToCard(this.currentCardIndex + 1);
                }
            }

            async prevCard() {
                if (this.currentCardIndex > 0) {
                    await this.goToCard(this.currentCardIndex - 1);
                }
            }

            flipCurrentCard() {
                const currentCard = this.cardStage.querySelector(`[data-index="${this.currentCardIndex}"]`);
                if (currentCard) {
                    const cardInner = currentCard.querySelector('.card-inner');
                    if (cardInner) {
                        gsap.to(cardInner, {
                            rotationY: '+=180',
                            duration: 1.2,
                            ease: 'power2.inOut'
                        });
                    }
                }
            }

            async show() {
                this.overlay.classList.add('active');
                
                const tl = gsap.timeline();
                
                tl.fromTo(this.overlay, 
                    { opacity: 0, scale: 0.9 },
                    { opacity: 1, scale: 1, duration: 0.6, ease: 'power2.out' }
                );
                
                const elements = [
                    '.carousel-header',
                    '.carousel-main',
                    '.carousel-sidebar',
                    '.carousel-panel',
                    '.carousel-footer'
                ];
                
                elements.forEach((selector, index) => {
                    const element = this.overlay.querySelector(selector);
                    if (element) {
                        tl.fromTo(element,
                            { opacity: 0, y: 30 },
                            { opacity: 1, y: 0, duration: 0.4, ease: 'power2.out' },
                            index * 0.1
                        );
                    }
                });
                
                return tl;
            }

            async showProgressively() {
                await this.show();
                
                for (let i = this.cards.length - 1; i >= 0; i--) {
                    this.currentCardIndex = i;
                    this.flipCurrentCard();
                    this.updateCardDetails();
                    await new Promise(resolve => setTimeout(resolve, this.config.autoProgressDelay));
                }
                
                this.currentCardIndex = this.cards.length;
                this.updateCardDetails();
            }

            async showAll() {
                await this.show();
                this.currentCardIndex = this.cards.length - 1;
                this.positionCards();
                this.updateProgress();
                this.updateCardDetails();
                this.updateMinimap();
                this.updateNavigation();
            }

            async closeCarousel() {
                if (this.isAnimating) return;
                
                this.isAnimating = true;
                
                const tl = gsap.timeline();
                tl.to(this.overlay, {
                    opacity: 0,
                    scale: 0.9,
                    duration: 0.5,
                    ease: 'power2.in',
                    onComplete: () => {
                        this.overlay.classList.remove('active');
                        this.cleanup();
                        console.log('Carousel closed');
                    }
                });
                
                return tl;
            }

            async requestAIAnalysis() {
                const question = this.aiInput.value.trim();
                if (!question) {
                    this.showInputError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å');
                    return;
                }
                
                this.setLoadingState(true);
                this.aiResponse.classList.add('visible');
                this.aiResponse.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px; color: var(--ai-color);">
                        <div class="loading-spinner"></div>
                        <span>–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –≤–∞—à —Ä–∞—Å–∫–ª–∞–¥...</span>
                    </div>
                `;
                
                try {
                    // Simulate AI response
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    const mockResponse = this.generateMockAIResponse(question);
                    this.displayAIResponse(mockResponse);
                } catch (error) {
                    console.error('AI Analysis error:', error);
                    this.aiResponse.innerHTML = `
                        <span style="color: #ff8a80;">
                            ‚ùå –ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.
                        </span>
                    `;
                } finally {
                    this.setLoadingState(false);
                }
            }

            generateMockAIResponse(question) {
                const cardsInfo = this.cards.map((card, index) => {
                    const themes = ['–í—ã–∑–æ–≤', '–ü—É—Ç—å', '–ò—Å—Ö–æ–¥'];
                    return `${themes[index]}: ${card.name}`;
                }).join(', ');
                
                return `
                    <strong>üîÆ –ê–Ω–∞–ª–∏–∑ –≤–∞—à–µ–≥–æ IT-—Ä–∞—Å–∫–ª–∞–¥–∞:</strong><br><br>
                    
                    **–û–±—â–∏–π –≤—ã–≤–æ–¥:** –í–∞—à —Ä–∞—Å–∫–ª–∞–¥ (${cardsInfo}) –≥–æ–≤–æ—Ä–∏—Ç –æ –≤–∞–∂–Ω–æ–º –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ –≤ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ñ–µ—Ä–µ.<br><br>
                    
                    **üî• –í—ã–∑–æ–≤ (${this.cards[0].name}):** –¢–µ–∫—É—â–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±—É—é—Ç –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∫ —Ä–µ—à–µ–Ω–∏—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º.<br><br>
                    
                    **üõ§Ô∏è –ü—É—Ç—å (${this.cards[1].name}):** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–º —Ä–∞–∑–≤–∏—Ç–∏–∏ –Ω–∞–≤—ã–∫–æ–≤ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –ø—Ä–æ—á–Ω–æ–≥–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞.<br><br>
                    
                    **‚ú® –ò—Å—Ö–æ–¥ (${this.cards[2].name}):** –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ –≤–∞—Å –∂–¥–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å—Ñ–µ—Ä–µ.<br><br>
                    
                    **üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**<br>
                    ‚Ä¢ –ò–∑—É—á–∏—Ç–µ –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ø–æ–ª–Ω—è—é—Ç –≤–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –Ω–∞–≤—ã–∫–∏<br>
                    ‚Ä¢ –ù–µ –±–æ–π—Ç–µ—Å—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø–æ–¥—Ö–æ–¥–∞–º–∏<br>
                    ‚Ä¢ –£–∫—Ä–µ–ø–ª—è–π—Ç–µ —Å–≤—è–∑–∏ –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ<br><br>
                    
                    *–ü–æ–º–Ω–∏—Ç–µ: –∫–∞—Ä—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏, –∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ –∑–∞ –≤–∞–º–∏!* üöÄ
                `;
            }

            displayAIResponse(text) {
                const formattedText = text
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\n/g, '<br>')
                    .replace(/(\d+\.)/g, '<br><strong>$1</strong>');
                
                this.aiResponse.innerHTML = formattedText;
                
                gsap.fromTo(this.aiResponse, 
                    { opacity: 0, y: 10 },
                    { opacity: 1, y: 0, duration: 0.5, ease: 'power2.out' }
                );
            }

            showInputError(message) {
                const originalBorder = this.aiInput.style.borderColor;
                
                gsap.to(this.aiInput, {
                    borderColor: '#ff4444',
                    boxShadow: '0 0 20px rgba(255, 68, 68, 0.3)',
                    duration: 0.3,
                    yoyo: true,
                    repeat: 1,
                    onComplete: () => {
                        this.aiInput.style.borderColor = originalBorder;
                        this.aiInput.style.boxShadow = '';
                    }
                });
                
                console.warn(message);
            }

            setLoadingState(isLoading) {
                const buttonText = this.overlay.querySelector('.ai-button-text');
                
                if (isLoading) {
                    this.aiButton.disabled = true;
                    if (buttonText) buttonText.textContent = '–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é...';
                    this.aiButton.classList.add('loading');
                } else {
                    this.aiButton.disabled = false;
                    if (buttonText) buttonText.textContent = '–°–ø—Ä–æ—Å–∏—Ç—å';
                    this.aiButton.classList.remove('loading');
                }
            }

            handleKeyboard(event) {
                if (!this.overlay.classList.contains('active')) return;
                
                switch (event.key) {
                    case 'ArrowLeft':
                        event.preventDefault();
                        this.prevCard();
                        break;
                    case 'ArrowRight':
                        event.preventDefault();
                        this.nextCard();
                        break;
                    case 'Escape':
                        event.preventDefault();
                        this.closeCarousel();
                        break;
                    case ' ':
                        event.preventDefault();
                        this.flipCurrentCard();
                        break;
                }
            }

            handleResize() {
                if (this.isInitialized && !this.isAnimating) {
                    this.positionCards();
                }
            }

            shuffleCards() {
                if (this.isAnimating) return;
                
                const tl = gsap.timeline();
                const cards = this.cardStage.querySelectorAll('.card-3d');
                
                tl.to(cards, {
                    rotation: () => Math.random() * 720 - 360,
                    scale: 0.8,
                    x: () => Math.random() * 200 - 100,
                    y: () => Math.random() * 200 - 100,
                    duration: 0.5,
                    ease: 'power2.inOut',
                    stagger: 0.05
                });
                
                tl.to(cards, {
                    rotation: 0,
                    scale: 1,
                    x: 0,
                    y: 0,
                    duration: 0.6,
                    ease: 'back.out(1.7)',
                    stagger: 0.05,
                    onComplete: () => this.positionCards()
                });
            }

            shareReading() {
                if (navigator.share) {
                    navigator.share({
                        title: '–ú–æ–π —Ä–∞—Å–∫–ª–∞–¥ –¢–∞—Ä–æ - –¶–∏—Ñ—Ä–æ–≤–æ–π –û—Ä–∞–∫—É–ª',
                        text: '–ü–æ—Å–º–æ—Ç—Ä–∏ –º–æ–π —Ä–∞—Å–∫–ª–∞–¥ –æ—Ç —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –æ—Ä–∞–∫—É–ª–∞!',
                        url: window.location.href
                    });
                } else {
                    const text = `–ú–æ–π —Ä–∞—Å–∫–ª–∞–¥ –¢–∞—Ä–æ:\n${this.cards.map((card, i) => {
                        const themes = ['–í—ã–∑–æ–≤', '–ü—É—Ç—å', '–ò—Å—Ö–æ–¥'];
                        return `${themes[i]}: ${card.name}`;
                    }).join('\n')}`;
                    
                    navigator.clipboard.writeText(text).then(() => {
                        console.log('–†–∞—Å–∫–ª–∞–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                        // Show success message
                        alert('–†–∞—Å–∫–ª–∞–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
                    }).catch(() => {
                        // Fallback for older browsers
                        prompt('–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç:', text);
                    });
                }
            }

            cleanup() {
                document.removeEventListener('keydown', this.handleKeyboard);
                window.removeEventListener('resize', this.handleResize);
                
                if (this.cardTimeline) {
                    this.cardTimeline.kill();
                }
                if (this.progressTimeline) {
                    this.progressTimeline.kill();
                }
                
                if (this.overlay) {
                    this.overlay.remove();
                }
                
                this.isInitialized = false;
                this.isAnimating = false;
                this.cards = [];
                this.currentCardIndex = 0;
            }
        }